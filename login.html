<!DOCTYPE html>
<html>
    <head>
        <script src="https://sdk.amazonaws.com/js/aws-sdk-2.476.0.min.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css">
        <script>
            AWS.config.region = 'us-east-1'; // Region
            AWS.config.credentials = new AWS.CognitoIdentityCredentials({
                IdentityPoolId: 'us-east-1:03dd8b12-9e10-484c-83ca-bfe0d55e16c3',
            });
            var lambda = new AWS.Lambda({region: 'us-east-1', apiVersion: '2015-03-31'});

            function login() {
                /*
                 call lambda function with a name and have it return picture
                 use window.location to change address to add the params gotten from the lambda script
                 
                 lambda function: 
                    will create space in the table for the user if they are new. 
                    Will choose a semi-random start point and store that

                    if user is not new it will retrieve the last photo they visited before they left
                */
                var name = document.getElementById('name').value;
                var params = {
                    'FunctionName' : 'login',
                    'name' : name
                };
                var response = lambda.invoke(params, function(err, data) {
                    if (err) {
                        window.alert("An error has occured please try again");
                        console.log(err);
                    }
                    else {
                        window.location = "identification.html?name="+name+"&image="+data['image'];
                    }
                }); 
                var image = response['image'];

                window.location = "identification.html?name="+name+"&image="+image;
            }
        </script>
    </head>
    <body>
        <h1 style = "text-align: center">Welcome to Stuart Knop's Eagle Scout Project for the Four Mile Run Conservancy</h1>
        <img src = "logos.png" alt = "logos" height = "100" class = "logos">
        <form>
            <h3 style = "text-align: center">Enter Your Name Below:</h3>
            <input class = "logos" type="text" id="name" placeholder="Name">
            <br>
            <input class = "logos" type="button" onclick="login()" value="Submit">
        </form>
    </body>
</html>